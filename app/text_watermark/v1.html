<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <title>文本去重工具</title>
    <link rel="stylesheet" type="text/css" href="diffview.css"/>
    <style type="text/css">
        body {
            font-size: 12px;
            font-family: Sans-Serif;
        }

        h2 {
            margin: 0.5em 0 0.1em;
            text-align: center;
        }

        .top {
            text-align: center;
        }

        .textInput {
            display: block;
        }

        .textOutput {
            display: block;
        }


        textarea {
            width: 100%;
            height: 300px;
        }

        label:hover {
            text-decoration: underline;
            cursor: pointer;
        }


        .viewType {
            font-size: 16px;
            clear: both;
            text-align: center;
            padding: 1em;
        }

        #diffoutput {
            width: 100%;
        }
    </style>

    <script type="text/javascript">

        function main() {
            var wm = document.getElementById("wm").value;
            var text = document.getElementById("baseText").value;

            var text_embed = embed(text, wm);

            document.getElementById("newText").innerHTML = text_embed;


        }


        function str2bin(str) {
            var result = [];
            var list = str.split("");
            for (var i = 0; i < list.length; i++) {
                if (i != 0) {
                    result.push(" ");
                }
                var item = list[i];
                var binaryStr = item.charCodeAt().toString(2);
                result.push(binaryStr);
            }
            return result.join("");
        }

        function bin2str(str) {
            var result = [];
            var list = str.split(" ");
            for (var i = 0; i < list.length; i++) {
                var item = list[i];
                var asciiCode = parseInt(item, 2);
                var charValue = String.fromCharCode(asciiCode);
                result.push(charValue);
            }
            return result.join("");
        }

        function embed(text, wm) {
            var wm_bin = str2bin(wm);
            var len_bin_wm = wm_bin.length;
            var len_text = text.length;
            if (len_bin_wm > len_text) {
                return "密文需要明文长度为" + len_bin_wm + "，不符合要求。";
            }


            var text_embed = "";
            for (var idx = 0; idx < len_text; idx++) {
                text_embed += text[idx];
                if (wm_bin[idx] === "1") {
                    text_embed += String.fromCharCode(127);
                } else if (wm_bin[idx] === " ") {
                    text_embed += String.fromCharCode(127);
                    text_embed += String.fromCharCode(127);
                }
            }

            return text_embed;


        }

    </script>
</head>


<body>
<h1 class="top">Text Distinct</h1>


<table width="100%">
    <tr>
        <td width="48%">
            <div class="textInput">
                <strong>需要埋入的密文：</strong>
                <input id="wm" type="text" name="" value="">

                <h2>明文</h2>
                <textarea id="baseText"></textarea>
            </div>
        </td>

        <td width="4%" align="middle">
            <button type="button" onclick="main();">embed=&gt;</button>
        </td>

        <td width="48%">
            <div class="textOutput">
                <h2>嵌入后的文字</h2>
                <textarea id="newText" readonly="readonly"></textarea>
            </div>
        </td>

    </tr>
</table>
<div id="diffoutput"></div>


说明：<br>
<ol>
    <ol>
    </ol>
    <li>作者 <a href="https://github.com/guofei9987">郭飞</a>，开源不易，请我喝咖啡</li>
    <img src="https://www.guofei.site/public/donate/WeChatQR.jpg" width=150 heght=150><br>
    <li>欢迎去<a href="https://www.guofei.site/">我的博客</a>看一眼。</li>
</ol>

</body>
</html>
